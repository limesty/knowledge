---
tags:
  - 学习/心理学
status: 尚未完成
---
# 重复测量方差分析 (Repeated-measures ANOVA)

## 本章概览

在进行被试内设计实验后，如果实验前后有多于两组数据，那么在数据分析时我们需要运用重复测量方差分析的统计手段。与独立组 ANOVA 相比，不同点在于 SS 组内可以进一步分解为 SS 被试间 + SS 误差。通过比较 Fobs 与 Fcrit 的大小，可以判断实验前后有无显著差别。如果有显著差别，可以进一步进行事后检验，并计算效应。
    
## 学习要点

1. 区分独立组 ANOVA 与重复测量 ANOVA
2. 理解重复测量 ANOVA 的方差分解
3. 学会计算 F 值并利用 F 检验完成重复测量 ANOVA
4. 掌握重复测量 ANOVA 事后检验的方法
5. 掌握重复测量 ANOVA 的统计前提
6. 学会计算重复测量 ANOVA 的效应值，并通过统计效力计算需要的被试数目

## 重复测量方差分析适用的情境

与独立样本设计不同，重复方差设计中，每个被试都参加了自变量所有水平下的测试，因此组间的变异不包括个体差异的影响，但是每一水平之内仍然是由不同的被试共同完成的。和独立样本相比，重复测量设计所需要的被试数目减少，更为经济。

## 重复测量方差分析的方差分解

- SS总和 = SS组间 + SS组内 = SS组间 + SS被试间 + SS误差
$$
\sum(X_i-\overline{X})^2=\sum(\overline{X}_T-\overline{X})^2+\sum(X_i-\overline{X}_T)^2=\sum(\overline{X}_T-\overline{X})^2+\sum(\overline{X}_P-\overline{X})^2+Error
$$
- 注：重复测量方差分析中，由于不考虑被试间的变异性（即个体差异），所以 $SS_{\text{组内}}$ 只需考虑$SS_{\text{误差}}$

### 和方的计算公式

- $k$ = 处理条件（或组）的数目
- $n$ =  每一个组的样本量（如果它们相等）
- $N$ = $\sum n_i$ = 总的观察数目
- $T_i$ = $\sum_j X_{ij}$ =第 $i$ 组观测值的总和
- $G$ = $\sum T_i$  总的和
- $SS_i$ = 每一个组的和方的和 = $\sum (X_{ij} - \overline{X}_i)^2$
- $P_i$ = 每一个被试的观测值的总和
- $SS_{\text{和}}=\sum X^2-\dfrac{G^2}{N}$
- $SS_{\text{组间}}=\sum\dfrac{T_i^2}{n_i}-\dfrac{G^2}{N}$
- $SS_{\text{组内}}=\sum SS_i$
- $SS_{\text{被试间}}=\sum\dfrac{P_i^2}{k}-\dfrac{G^2}{N}$
- $SS_{\text{误差}}=SS_{\text{组内}}-SS_{\text{被试间}}$

### 自由度

共有5个自由度, 2个计算均方时要用到
1. 总的 $df = N-1$
2. 组间方差 $df = k-1$
3. 组内方差 $df = N-k$
4. 被试间方差 $df = n-1$
5. 误差方差 $df = (N-k) -(n-1)= N-k-n+1$

## 重复测量方差分析的F值计算

1. 陈述假设，一般只需给出虚无假设H0；
2. 给出显著性水平；
3. 确定检验的自由度；
4. 由分子分母的自由度，确定F值的临界值；
5. 计算样本的F统计量。

- F=组间平均变异 / 误差平均变异

## 重复测量方差的事后检验

ANOVA得到一个两点决策，但并未知道差异存在在哪些组之间。这时我们需要进行事后检验，这使得我们能够比较各个组，找到差异存在在哪些组之间。事后检验就是比较每一个处理组和另一个处理组，一次比较两个，称为成对比较。

### 重复测量方差的 Tukey's HSD 检验

重复测量方差HSD值的计算和单因素方差分析的HSD值计算有所不同。


重复测量方差HSD值的计算如下： 
$$
HSD=q\sqrt{\dfrac{MS_{\text{误差}}}{n}}
$$

公式中用误差的和方，自由度，均方代替原来分母项的组内和方，自由度，均方。 其中q值可以从表中查出，需要用到 $K$（处理数），$df_{\text{误差}}$ 以及显著性水平 $\alpha$。

得到 HSD 值之后，将样本两两均值之差与 HSD 值作比较，大于 HSD 值则认为这两组之间有显著差异。

## 重复测量方差分析的统计前提

- 每个处理条件内的观察都是独立的；
- 每个处理条件内的总体分布是正态分布；
- 每个处理条件间的方差同质。

## 重复测量方差分析的效应大小

重复测量方差分析(Repeated measures ANOVA)的效应大小：  
$$
\eta^2=\dfrac{SS_{\text{组间}}}{SS_{\text{组间}}+SS_{\text{误差}}}
$$
单因素组间方差分析 (One-way between-groups ANOVA) 的效应大小 (Cohen’s f，可以写作 f) ：
$$
f=\sqrt{\dfrac{F_{effect}\times df_{effect}}{df_{error}}}
$$

两者间的关系：
$$
f=\sqrt{\dfrac{\eta^2}{1-\eta^2}}
$$

## 重复测量方差分析的统计效力

